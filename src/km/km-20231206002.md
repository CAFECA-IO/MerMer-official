---
date: 1701850469
title: 'EIP-1559(II)'
description: '一種包含固定每個區塊網路費用的交易定價機制，這些費用被銷毀，並動態擴展/縮小區塊大小以應對瞬時擁塞情況。'
picture: '/km/AI-ETH.jpg'
category: ['KM_CATEGORY.CRYPTOCURRENCY', 'KM_CATEGORY.BLOCKCHAIN_TECHNOLOGY']
authorId: 'yang'
---

## EIP-1559 raw transaction sample and algorithm

### 假設我們有一個 EIP-1559 raw transaction sample//可以在 etherescan 中查找:

```ts
0x02f902fa0181b483a6792e850244ddce8e83045ee9943fc91a3afd70395cd496c647d5a6cc9d4b2b7fad8802c68af0bb140000b902843593564c000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000006508457f00000000000000000000000000000000000000000000000000000000000000020b080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000002c68af0bb1400000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000002c68af0bb140000000000000000000000000000000000000000000000001886271c2fb90c220a4d00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000003850952491606a0e420eb929b1a2e1a450d013f1c001a08b50ee3e376edb0fc0719ecb19a38dd7558285ba61b15c30083369bb76bfb393a069dc859312719259201ffae0c78208abc1b4e93ed05fd782f754dbe9eec75231;
```

解析後得到 JSON object：

```json
{
  "chainId": "1",
  "type": "EIP-1559",
  "valid": true,
  "hash": "0x9d0de6855390ff87e9fe9ca8a8e07e6a8819f29531ea69dc701f96268080440d",
  "nonce": "180",
  "gasLimit": "286441",
  "maxFeePerGas": "9745321614",
  "maxPriorityFeePerGas": "10909998",
  "from": "0x7C71e3C2dC48557336961e0adc390164C8b045b6",
  "to": "0x3fc91a3afd70395cd496c647d5a6cc9d4b2b7fad",
  "publicKey": "0x042e53305a01238bbb049d4f4d4c06b9aabaf42297bb2368f9263fb2e155fd9fce02bdd0e0e1a97632e4da7e11605423563a70fe78c146ab4ee89f234204f60d0c", //
  "v": "01",
  "r": "8b50ee3e376edb0fc0719ecb19a38dd7558285ba61b15c30083369bb76bfb393",
  "s": "69dc859312719259201ffae0c78208abc1b4e93ed05fd782f754dbe9eec75231",
  "value": "200000000000000000",
  "data": "0x3593564c000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000006508457f00000000000000000000000000000000000000000000000000000000000000020b080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000002c68af0bb1400000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000002c68af0bb140000000000000000000000000000000000000000000000001886271c2fb90c220a4d00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000003850952491606a0e420eb929b1a2e1a450d013f1", //
  "functionHash": "0x3593564c", //
  "possibleFunctions": [
    {
      "definition": "execute(bytes,bytes[],uint256)", //
      "decodedInputs": [
        "0b08", //
        [
          "000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000002c68af0bb140000",
          "000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000002c68af0bb140000000000000000000000000000000000000000000000001886271c2fb90c220a4d00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000003850952491606a0e420eb929b1a2e1a450d013f1" //
        ],
        "1695040895" //
      ]
    }
  ]
}
```

### 解析內容

1.  "chianId:1" 代表以太坊主網（補充："3"代表 Ropsten 使用 PoW 算法, "4"代表 Rinkeby 是以太坊的 PoA
    的測試網路, "42"代表 Kovan 使用 Clique 算法, "100"代表 XDai 提供快速的交易, 其他 chainID 可以
    在[chainlist.org](https://chainlist.org/)查找）
2.  "Type:EIP-1559": 代表交易類型
3.  "valid:true": 表示交易有效且可以被處理
4.  "hash": 是一個唯一標識符，16 進制字串，類似於收據，用作交易已驗證並添加到區塊鏈的證據。在許多情
    況下，需要 hash 來定位資金。
5.  "nonce": 是發送者地址的計數，確保交易按正確的順序處理並防止雙重支付，此交易來說，這是使用者錢包
    的第 180 次交易 //180 = b4
6.  "gaslimit": 用於此交易的最大 Gas 限制
7.  "maxFeePerGas": 告知以太坊區塊鏈用戶願意花費的最大金額
8.  "maxPriorityFeePerGas" 用戶願意支付的最高小費金額
9.  "from","to": 使用者與接收者的以太坊地址
10. "publicKey": 以太坊公鑰是橢圓曲線上滿足橢圓曲線方程式的一組 x 和 y 座標。它是透過使用橢圓曲線乘
    法從私鑰產生的兩個數字得出的。這個過程是不可逆的，這意味著私鑰不能從公鑰推導出來。請參見演算法章
    節
11. "v","r","s": r 和 s 是 ECDSA（Elliptic Curve Digital Signature Algorithm） 簽名的輸出， v 是恢復
    ID。
12. "value": 以 Wei 為單位表示的以太幣金額。在此交易中，它是 200,000,000,000,000,000 Wei，相當於 0.2
    以太幣
13. "data": 函數調用及其參數
14. "functionHash": data 字段串調用的函數的 hash 值
15. "possibleFunctions"：呼叫了名為『execute(bytes,bytes[],uint256)』的函數，並提供了特定的解碼輸入
    (decodedInputs)

### 解析詳細過程

| Syntex                                                                                                     | Description                                                                         |
| ---------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| 0x02                                                                                                       | EIP-1559                                                                            |
| F9                                                                                                         | F9 = f7 + 2 (告訴你後面兩 bytes(4 個字),是宣告整篇的長度)                           |
| 02fa                                                                                                       | 02fa = 762, 762\*2 = 1524                                                           |
| 01                                                                                                         | chainID                                                                             |
| 81 b4(decimal:180)                                                                                         | Nonce                                                                               |
| 83 a6792e                                                                                                  | maxPriorityFeePerGas                                                                |
| 85 0244ddce8e                                                                                              | maxFeePerGas                                                                        |
| 83 045ee9                                                                                                  | gasLimit                                                                            |
| 94 3fc91a3afd70395cd496c647d5a6cc9d4b2b7fad                                                                | To                                                                                  |
| 88 02c68af0bb140000                                                                                        | Value                                                                               |
| b9 0284                                                                                                    | b9>b7(185 >183),185-183 = 2,告訴你後面兩 bytes(4 個字),是宣告 data 的長度(0284=644) |
| 3593564c000000...~C0                                                                                       | Data                                                                                |
| 84 3593564c                                                                                                | Function hash                                                                       |
| 6508457f                                                                                                   | unit256                                                                             |
| 0b08                                                                                                       | decode input[0]                                                                     |
| 0000000...0000000000000000002c68af0bb140000                                                                | decode input[1,0]                                                                   |
| ...2000000...0000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000...003850952491606a0e420eb929b1a2e1a450d013f1 | decode input[1,1]                                                                   |
| 6508457f(1695040895)                                                                                       | decode input [2]                                                                    |
| c0                                                                                                         | 空列表,表示 data 結束進入 VRS 簽名部分                                              |
| 01                                                                                                         | V                                                                                   |
| a0                                                                                                         | 分隔符                                                                              |
| 8b50ee3e376edb0fc0719ecb19a38dd7558285ba61b15c30083369bb76bfb393                                           | R                                                                                   |
| a0                                                                                                         | 分隔符                                                                              |
| 69dc859312719259201ffae0c78208abc1b4e93ed05fd782f754dbe9eec75231                                           | S                                                                                   |

//
